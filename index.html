<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXT-HUB | Portal</title>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css" />
    <link rel="icon" href="favicon.ico" sizes="any">
    <link rel="apple-touch-icon" href="favicon.ico" sizes="180x180">

    
    <style>
        :root {
            --bg-body: #0a0a0a;
            --bg-header: linear-gradient(135deg, #1a1a1a 0%, #0d0d0d 100%);
            --bg-card: #181818;
            --bg-nav: rgba(13, 13, 13, 0.95);
            --bg-sidebar: #121212;
            --text-main: #ffffff;
            --text-sub: #a0a0a0;
            --border-color: #2c2c2c;
            --scratch-blue: #4d97ff;
            --like-color: #ff4757;
            --accent-green: #2ecc71;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Inter', 'Noto Sans JP', sans-serif; background-color: var(--bg-body); color: var(--text-main); line-height: 1.6; overflow-x: hidden; }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        #home-radio, #tools-radio, #sidebar-check { display: none !important; }
        nav { padding: 10px 5%; display: flex; justify-content: space-between; align-items: center; background: var(--bg-nav); backdrop-filter: blur(15px); position: sticky; top: 0; z-index: 100; border-bottom: 1px solid var(--border-color); }
        .logo { font-weight: 700; font-size: 1.3rem; letter-spacing: 1px; }
        .search-box { background: #222; border: 1px solid #333; padding: 8px 15px; border-radius: 20px; color: #fff; width: 180px; outline: none; transition: 0.3s; }
        .search-box:focus { width: 240px; border-color: var(--scratch-blue); }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar { position: fixed; top: 0; left: -300px; width: 300px; height: 100%; background: var(--bg-sidebar); z-index: 150; transition: 0.4s; padding: 80px 20px; border-right: 1px solid var(--border-color); }
        #sidebar-check:checked ~ .sidebar { left: 0; }
        .sidebar-item { display: block; color: var(--text-main); text-decoration: none; padding: 15px 10px; cursor: pointer; border-radius: 8px; margin-bottom: 5px; }
        .sidebar-item:hover { background: #222; color: var(--scratch-blue); }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 140; display: none; }
        #sidebar-check:checked ~ .overlay { display: block; }

        /* ãƒ˜ãƒƒãƒ€ãƒ¼ */
        header { text-align: center; padding: 40px 20px; background: var(--bg-header); border-bottom: 1px solid var(--border-color); }
        .status-badge { display: inline-block; padding: 6px 16px; border-radius: 20px; font-size: 0.85rem; font-weight: bold; margin-bottom: 15px; }
        .status-on { background: rgba(46, 204, 113, 0.2); color: var(--accent-green); border: 1px solid var(--accent-green); }
        .status-off { background: rgba(231, 76, 60, 0.2); color: #e74c3c; border: 1px solid #e74c3c; }

        /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ */
        .swiper { width: 100%; padding: 30px 0; border-bottom: 1px solid var(--border-color); }
        .swiper-slide { width: 260px; cursor: pointer; text-align: center; }
        .swiper-slide img { 
            width: 100%; 
            height: 150px; 
            object-fit: cover; 
            border-radius: 12px; 
            border: 1px solid var(--border-color);
            transition: 0.3s;
        }
        /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ã‚’ç­‰é€Ÿã§å‹•ã‹ã™ãŸã‚ã®è¨­å®š */
.swiper-wrapper {
    transition-timing-function: linear !important;
}
        .swiper-slide:hover img { border-color: var(--scratch-blue); transform: scale(1.05); }
        .swiper-slide span { display: block; margin-top: 8px; font-size: 0.9rem; color: var(--text-sub); }

        /* ã‚°ãƒªãƒƒãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        .container { max-width: 1200px; margin: 0 auto; padding: 40px 5%; }
        .page-content { display: none; animation: fadeIn 0.4s; }
        #home-radio:checked ~ .container #home-page,
        #tools-radio:checked ~ .container #tools-page { display: block; }

        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 25px; }
        .card { background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 16px; padding: 20px; transition: 0.3s; }
        .card:hover { border-color: #444; transform: translateY(-5px); }
        .card img { 
            width: 100%; 
            aspect-ratio: 4 / 3; 
            object-fit: cover; 
            border-radius: 10px; 
            margin-bottom: 15px;
            border: 1px solid #333;
        }
        .search-hide { display: none !important; }

        /* é›»å“ãƒ‘ãƒ¼ãƒ„ */
        .calc-display { width: 100%; padding: 15px; background: #000; color: var(--accent-green); text-align: right; font-size: 1.5rem; border-radius: 8px; margin-bottom: 10px; border: 1px solid #333; }
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .calc-btn { padding: 12px; border: none; border-radius: 6px; background: #2a2a2a; color: white; cursor: pointer; font-weight: bold; }
        .calc-btn:hover { background: #333; }
        .calc-btn.op { background: var(--scratch-blue); }

        .btn { padding: 10px 20px; border-radius: 8px; cursor: pointer; border: none; font-weight: 700; text-decoration: none; display: inline-block; transition: 0.3s; text-align: center; }
        .btn-blue { background: var(--scratch-blue); color: white; width: 100%; margin-top: 10px; }
        .btn-like { background: var(--like-color); color: white; border-radius: 50px; }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <input type="radio" name="page" id="home-radio" checked>
    <input type="radio" name="page" id="tools-radio">
    <input type="checkbox" id="sidebar-check">

    <nav>
        <div class="nav-left">
            <label for="sidebar-check" style="cursor:pointer; font-size:1.5rem;">â˜°</label>
            <span class="logo" style="margin-left:15px;">NEXT-HUB</span>
        </div>
        <input type="text" id="js-search" class="search-box" placeholder="ä½œå“ã‚’æ¤œç´¢...">
    </nav>

    <aside class="sidebar">
        <label for="home-radio" class="sidebar-item" onclick="closeSidebar()">ğŸ  ãƒ›ãƒ¼ãƒ </label>
        <label for="tools-radio" class="sidebar-item" onclick="closeSidebar()">ğŸ›  ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«</label>
    </aside>
    <label for="sidebar-check" class="overlay"></label>

    <header>
        <div id="weather-text" style="color: var(--accent-green); font-size: 0.9rem;">Tokyo: --Â°C</div>
        <h1 style="margin: 10px 0;">NEXT-HUB Portal</h1>
        <div id="contact-status" class="status-badge">ç¢ºèªä¸­...</div><br>
        <button class="btn btn-like" onclick="sendLike()">â¤ <span id="like-count">0</span> Likes</button>
    </header>

    <div class="swiper">
        <div class="swiper-wrapper">
            <div class="swiper-slide">
                <img src="https://scratch.mit.edu/get_image/project/1259915297_480x360.png">
                <span>ãƒ–ãƒ¬ã‚¤ãƒ³ãƒ­ãƒƒãƒˆ ã‚¯ãƒªãƒƒã‚«ãƒ¼</span>
            </div>
            <div class="swiper-slide">
                <img src="https://scratch.mit.edu/get_image/project/307476661_480x360.png">
                <span>3D Open World</span>
            </div>
            <div class="swiper-slide">
                <img src="https://uploads.scratch.mit.edu/get_image/project/1163188471_480x360.png">
                <span>ã‚ªãƒ¬ãƒ³ã‚¸ãƒ”ãƒ³ãƒãƒ³</span>
            </div>
            <div class="swiper-slide">
                <img src="https://uploads.scratch.mit.edu/get_image/project/1134606936_480x360.png">
                <span>ä¾¿åˆ©ãƒ„ãƒ¼ãƒ« (Scratchç‰ˆ)</span>
            </div>
                        <div class="swiper-slide">
                <img src="https://uploads.scratch.mit.edu/get_image/project/1261118333_480x360.png">
                <span>ç«‹ã¡çµµä½œã£ãŸã‚ˆãƒ¼ï¼</span>
            </div>
                        <div class="swiper-slide">
                <img src="https://uploads.scratch.mit.edu/get_image/project/1238399568_480x360.png">
                <span>Get The Frog Out Of Here!</span>
            </div>
                                    <div class="swiper-slide">
                <img src="https://uploads.scratch.mit.edu/get_image/project/668123415_480x360.png">
                <span>â˜ï¸ã‚¢ãƒ¢ãƒ³ã‚°ã‚¢ã‚¹ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ æ—¥æœ¬èªç‰ˆ / Among Us Online Scratch Remake Japanese Version</span>
            </div>
                                                <div class="swiper-slide">
                <img src="https://uploads.scratch.mit.edu/get_image/project/1239803192_480x360.png">
                <span>ã‚¹ã‚¯ãƒ©ãƒ ã‚¹ / SCRAMNS</span>
            </div>
        </div>
    </div>

    <main class="container">
        <div id="home-page" class="page-content">
            <h2 style="margin-bottom:20px;">ğŸ“‚ ä½œå“ä¸€è¦§</h2>
            <div class="grid">
                <div class="card scratch-project">
                    <img src="https://scratch.mit.edu/get_image/project/1259915297_480x360.png">
                    <h3>ãƒ–ãƒ¬ã‚¤ãƒ³ãƒ­ãƒƒãƒˆ ã‚¯ãƒªãƒƒã‚«ãƒ¼</h3>
                    <a href="https://scratch.mit.edu/projects/1259915297/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                <div class="card scratch-project">
                    <img src="https://scratch.mit.edu/get_image/project/307476661_480x360.png">
                    <h3>3D Open World</h3>
                    <a href="https://scratch.mit.edu/projects/307476661/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                <div class="card scratch-project">
                    <img src="https://uploads.scratch.mit.edu/get_image/project/1163188471_480x360.png">
                    <h3>ã‚ªãƒ¬ãƒ³ã‚¸ãƒ”ãƒ³ãƒãƒ³</h3>
                    <a href="https://scratch.mit.edu/projects/1163188471/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                <div class="card scratch-project">
                    <img src="https://uploads.scratch.mit.edu/get_image/project/1134606936_480x360.png">
                    <h3>ä¾¿åˆ©ãƒ„ãƒ¼ãƒ« (Scratchç‰ˆ)</h3>
                    <a href="https://scratch.mit.edu/projects/1134606936/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                <div class="card scratch-project">
                    <img src="https://uploads.scratch.mit.edu/get_image/project/1261118333_480x360.png">
                    <h3>ç«‹ã¡çµµä½œã£ãŸã‚ˆãƒ¼ï¼</h3>
                    <a href="https://scratch.mit.edu/projects/1261118333/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                <div class="card scratch-project">
                    <img src="https://uploads.scratch.mit.edu/get_image/project/1238399568_480x360.png">
                    <h3>Get The Frog Out Of Here!</h3>
                    <a href="https://scratch.mit.edu/projects/1238399568/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                                    <img src="https://uploads.scratch.mit.edu/get_image/project/668123415_480x360.png">
                    <h3>â˜ï¸ã‚¢ãƒ¢ãƒ³ã‚°ã‚¢ã‚¹ ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ æ—¥æœ¬èªç‰ˆ / Among Us Online Scratch Remake Japanese Version</h3>
                    <a href="https://scratch.mit.edu/projects/668123415/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
                                                <img src="https://uploads.scratch.mit.edu/get_image/project/1239803192_480x360.png">
                    <h3>ã‚¹ã‚¯ãƒ©ãƒ ã‚¹ / SCRAMNS</h3>
                    <a href="https://scratch.mit.edu/projects/1239803192/" class="btn btn-blue" target="_blank">é–‹ã</a>
                </div>
            </div>
        </div>

        <div id="tools-page" class="page-content">
            <h2>ğŸ›  ãƒ„ãƒ¼ãƒ«</h2>
            <div class="grid">
                <div class="card">
                    <h3>ğŸ”¢ é›»å“</h3>
                    <input type="text" id="calc-display" class="calc-display" readonly value="0">
                    <div class="calc-grid">
                        <button class="calc-btn" onclick="pressCalc('7')">7</button>
                        <button class="calc-btn" onclick="pressCalc('8')">8</button>
                        <button class="calc-btn" onclick="pressCalc('9')">9</button>
                        <button class="calc-btn op" onclick="pressCalc('/')">Ã·</button>
                        <button class="calc-btn" onclick="pressCalc('4')">4</button>
                        <button class="calc-btn" onclick="pressCalc('5')">5</button>
                        <button class="calc-btn" onclick="pressCalc('6')">6</button>
                        <button class="calc-btn op" onclick="pressCalc('*')">Ã—</button>
                        <button class="calc-btn" onclick="pressCalc('1')">1</button>
                        <button class="calc-btn" onclick="pressCalc('2')">2</button>
                        <button class="calc-btn" onclick="pressCalc('3')">3</button>
                        <button class="calc-btn op" onclick="pressCalc('-')">-</button>
                        <button class="calc-btn" onclick="clearCalc()">C</button>
                        <button class="calc-btn" onclick="pressCalc('0')">0</button>
                        <button class="calc-btn op" onclick="calculate()">=</button>
                        <button class="calc-btn op" onclick="pressCalc('+')">+</button>
                    </div>
                </div>
                <div class="card">
                    <h3>ğŸ“ ãƒ¡ãƒ¢</h3>
                    <p style="font-size: 0.8rem; color: var(--text-sub); margin-bottom: 8px;">ãƒ–ãƒ©ã‚¦ã‚¶ã«ä¿å­˜ã•ã‚Œã¾ã™</p>
                    <textarea id="memo-area" style="width:100%; height:160px; background:#000; color:#fff; border:1px solid #333; padding:10px; border-radius:5px; resize: none;"></textarea>
                    <button onclick="saveMemo()" class="btn btn-blue">ä¿å­˜ã™ã‚‹</button>
                </div>
                <div class="card">
    <h3>ğŸ” ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆ</h3>
    <p id="pass-display" style="background:#000; padding:10px; border-radius:5px; margin:10px 0; font-family:monospace; word-break:break-all; border:1px solid #333;">********</p>
    <input type="range" id="pass-length" min="8" max="32" value="12" style="width:100%;">
    <p style="font-size:0.8rem; text-align:right;">é•·ã•: <span id="length-val">12</span></p>
    <button onclick="generatePass()" class="btn btn-blue">ç”Ÿæˆã™ã‚‹</button>
</div>

<div class="card">
    <h3>â± ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼</h3>
    <div id="timer-display" style="font-size: 2.5rem; text-align: center; font-weight: bold; color: var(--scratch-blue); margin: 10px 0;">25:00</div>
    <div style="display: flex; gap: 5px;">
        <button onclick="toggleTimer()" id="timer-btn" class="btn btn-blue" style="flex:2;">ã‚¹ã‚¿ãƒ¼ãƒˆ</button>
        <button onclick="resetTimer()" class="btn" style="background:#333; color:white; flex:1;">Reset</button>
    </div>
</div>
<div class="card">
    <h3>ğŸ“µ è¶…é›†ä¸­ãƒ¢ãƒ¼ãƒ‰</h3>
    <div id="focus-display" style="text-align:center; padding:20px;">
        <div id="focus-timer" style="font-size:2rem; margin-bottom:10px;">--:--</div>
        <p id="focus-status" style="font-size:0.8rem; color:var(--text-sub);">ç›®çš„ã‚’è¨­å®šã—ã¦ãƒ­ãƒƒã‚¯</p>
    </div>
    <div id="focus-controls">
        <input type="text" id="focus-reason" placeholder="ä»Šã‹ã‚‰ä½•ã‚’æˆã—é‚ã’ã‚‹ï¼Ÿ" style="width:100%; padding:8px; background:#000; border:1px solid #333; color:#fff; border-radius:5px; margin-bottom:10px;">
        <button onclick="startFocus()" class="btn btn-blue">é›†ä¸­ã‚’é–‹å§‹ã™ã‚‹</button>
    </div>
</div>

<div class="card">
    <h3>ğŸ’° æ„Ÿæƒ…å®¶è¨ˆç°¿</h3>
    <div style="display:flex; gap:10px; margin-bottom:10px;">
        <input type="number" id="spend-amount" placeholder="é‡‘é¡" style="flex:1; background:#000; border:1px solid #333; color:#fff; padding:8px; border-radius:5px;">
        <select id="spend-emotion" style="background:#000; border:1px solid #333; color:#fff; padding:8px; border-radius:5px;">
            <option value="ğŸ˜Š">æœ€é«˜ï¼</option>
            <option value="ğŸ˜">æ™®é€š</option>
            <option value="ğŸ˜¢">å¾Œæ‚”...</option>
        </select>
    </div>
    <button onclick="addSpend()" class="btn btn-blue" style="background:var(--accent-green);">è¨˜éŒ²ã™ã‚‹</button>
    <div id="spend-history" style="margin-top:15px; max-height:100px; overflow-y:auto; font-size:0.85rem;">
        </div>
</div>
<div class="card">
    <h3>ğŸ–¼ ã‚¹ã‚¯ã‚·ãƒ§è§£æãƒ»åˆ†é¡</h3>
    <p style="font-size: 0.8rem; color: var(--text-sub); margin-bottom: 10px;">ç”»åƒã‚’è§£æã—ã¦æƒ…å ±ã‚’æŠ½å‡ºã—ã¾ã™</p>
    
    <label class="btn btn-blue" style="display: block; background: #333;">
        ç”»åƒã‚’é¸æŠ
        <input type="file" id="screenshot-input" accept="image/*" style="display:none;">
    </label>

    <div id="ocr-status" style="font-size: 0.8rem; margin-top:10px; color: var(--scratch-blue);"></div>
    
    <div id="analysis-result" style="margin-top:15px; display:none;">
        <span id="category-tag" style="padding:2px 8px; border-radius:4px; font-size:0.75rem; background:var(--accent-green);">åˆ†é¡ä¸­...</span>
        <textarea id="ocr-text" style="width:100%; height:80px; background:#000; color:#fff; border:1px solid #333; margin-top:10px; padding:5px; font-size:0.8rem; border-radius:5px;"></textarea>
        <button id="copy-ocr-btn" class="btn" style="width:100%; font-size:0.8rem; margin-top:5px; background:#444; color:white;">ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚³ãƒ”ãƒ¼</button>
    </div>
</div>
<div class="card">
    <h3>ğŸ“‚ ã‚³ãƒ¼ãƒ‰æ•´ç†ãƒ»çŸ­ç¸®</h3>
    <p style="font-size: 0.8rem; color: var(--text-sub); margin-bottom: 10px;">JavaScript/CSSã®æ•´å½¢ãƒ»è»½é‡åŒ–</p>
    
    <textarea id="code-input" placeholder="ã“ã“ã«ã‚³ãƒ¼ãƒ‰ã‚’è²¼ã‚Šä»˜ã‘..." style="width:100%; height:120px; background:#000; color:#00ff00; border:1px solid #333; padding:10px; font-family:monospace; font-size:0.8rem; border-radius:5px; resize:vertical;"></textarea>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
        <button onclick="processCode('format')" class="btn" style="background:#444; color:white; font-size:0.8rem;">ç¶ºéº—ã«æ•´å½¢</button>
        <button onclick="processCode('minify')" class="btn btn-blue" style="font-size:0.8rem;">é™ç•Œã¾ã§çŸ­ç¸®</button>
    </div>
</div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
    <script>

    // --- è¶…é›†ä¸­ãƒ¢ãƒ¼ãƒ‰ ãƒ­ã‚¸ãƒƒã‚¯ ---
let focusInterval = null;
function startFocus() {
    const reason = document.getElementById('focus-reason').value;
    if (!reason) return alert("é›†ä¸­ã™ã‚‹ç›®çš„ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼");

    const overlay = document.createElement('div');
    overlay.id = 'focus-overlay';
    overlay.style = "position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.98); z-index:9999; display:flex; flex-direction:column; align-items:center; justify-content:center; color:white; font-family:sans-serif;";
    
    overlay.innerHTML = `
        <h1 style="margin-bottom:20px;">ğŸ”¥ é›†ä¸­ãƒ¢ãƒ¼ãƒ‰ç™ºå‹•ä¸­</h1>
        <p style="color:var(--text-sub); margin-bottom:40px;">ç›®çš„: ${reason}</p>
        <p style="font-size:0.9rem; margin-bottom:10px;">è§£é™¤ã™ã‚‹ã«ã¯ä»¥ä¸‹ã‚’æ­£ç¢ºã«å…¥åŠ›ã—ã¦ãã ã•ã„:</p>
        <p style="font-weight:bold; color:var(--scratch-blue); margin-bottom:10px;">ã€Œ${reason}ã‚’è«¦ã‚ã¾ã™ã€</p>
        <input type="text" id="unlock-input" placeholder="ã“ã“ã«ç†ç”±ã‚’å…¥åŠ›..." style="background:transparent; border:none; border-bottom:2px solid #333; color:#fff; text-align:center; font-size:1.2rem; outline:none; margin-bottom:20px;">
        <button onclick="checkUnlock('${reason}')" class="btn" style="background:#e74c3c; color:white;">ãƒ­ãƒƒã‚¯è§£é™¤ã‚’è©¦ã¿ã‚‹</button>
    `;
    document.body.appendChild(overlay);
}

function checkUnlock(reason) {
    const input = document.getElementById('unlock-input').value;
    if (input === `${reason}ã‚’è«¦ã‚ã¾ã™`) {
        document.getElementById('focus-overlay').remove();
        alert("é›†ä¸­ãƒ¢ãƒ¼ãƒ‰ã‚’çµ‚äº†ã—ã¾ã—ãŸã€‚ãŠç–²ã‚Œæ§˜ã§ã—ãŸï¼");
    } else {
        alert("å…¥åŠ›ãŒæ­£ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚ã¾ã é›†ä¸­ã—ã¾ã—ã‚‡ã†ï¼");
    }
}

// --- æ„Ÿæƒ…å®¶è¨ˆç°¿ ãƒ­ã‚¸ãƒƒã‚¯ ---
function addSpend() {
    const amt = document.getElementById('spend-amount').value;
    const emo = document.getElementById('spend-emotion').value;
    if(!amt) return;

    const history = document.getElementById('spend-history');
    const item = document.createElement('div');
    item.style = "display:flex; justify-content:space-between; padding:5px 0; border-bottom:1px solid #222;";
    item.innerHTML = `<span>${emo} Â¥${Number(amt).toLocaleString()}</span> <span style="color:var(--text-sub);">${new Date().toLocaleTimeString()}</span>`;
    
    history.prepend(item);
    document.getElementById('spend-amount').value = "";
}
        function closeSidebar() { document.getElementById('sidebar-check').checked = false; }
        
        // å¤©æ°—å–å¾—
        async function fetchWeather() {
            try {
                const res = await fetch('https://api.open-meteo.com/v1/forecast?latitude=35.68&longitude=139.76&current_weather=true');
                const d = await res.json();
                document.getElementById('weather-text').innerText = `Tokyo: ${d.current_weather.temperature}Â°C`;
            } catch (e) { document.getElementById('weather-text').innerText = "Weather unavailable"; }
        }

        // å—ä»˜ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹
        function updateStatus() {
            const hr = new Date().getHours();
            const el = document.getElementById('contact-status');
            // 17:00 - 22:00ã®é–“ã ã‘ã€Œå—ä»˜ä¸­ã€
            if (hr >= 17 && hr < 22) { 
                el.innerText = "ğŸŸ¢ å—ä»˜ä¸­"; 
                el.className = "status-badge status-on"; 
            } else { 
                el.innerText = "ğŸ”´ æ™‚é–“å¤– (17:00-22:00)"; 
                el.className = "status-badge status-off"; 
            }
        }

        // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è¨­å®šï¼ˆç„¡é™ãƒ«ãƒ¼ãƒ—ãƒ»è‡ªå‹•å†ç”Ÿï¼‰
// ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼è¨­å®šï¼ˆã‚·ãƒ¼ãƒ ãƒ¬ã‚¹ãªç­‰é€Ÿãƒ«ãƒ¼ãƒ—ï¼‰
const swiper = new Swiper('.swiper', {
    loop: true,
    speed: 6000, // 6ç§’ã‹ã‘ã¦1å‘¨åˆ†ç§»å‹•ï¼ˆãŠå¥½ã¿ã®é€Ÿåº¦ã«èª¿æ•´ã—ã¦ãã ã•ã„ï¼‰
    slidesPerView: 'auto',
    spaceBetween: 20,
    allowTouchMove: true, // æ‰‹å‹•ã§ã®æ“ä½œã‚‚å¯èƒ½
    autoplay: {
        delay: 0, // æ­¢ã¾ã‚‹æ™‚é–“ã‚’ã‚¼ãƒ­ã«ã™ã‚‹
        disableOnInteraction: false,
    },
    freeMode: {
        enabled: true,
        momentum: false,
    },
});

        // é›»å“ãƒ­ã‚¸ãƒƒã‚¯
        let calcVal = "0";
        function pressCalc(v) { 
            if(calcVal === "0" && !isNaN(v)) calcVal = ""; 
            calcVal += v; 
            document.getElementById('calc-display').value = calcVal; 
        }
        function clearCalc() { 
            calcVal = "0"; 
            document.getElementById('calc-display').value = "0"; 
        }
        function calculate() { 
            try { 
                // å®‰å…¨ãªè¨ˆç®—ã®ãŸã‚ã«evalã®ä»£ã‚ã‚Šã«Functionã‚’ä½¿ã†ã“ã¨ã‚‚æ¤œè¨ã§ãã¾ã™ãŒã€ä»Šå›ã¯ã‚·ãƒ³ãƒ—ãƒ«ã«
                calcVal = eval(calcVal).toString(); 
                document.getElementById('calc-display').value = calcVal; 
            } catch { 
                document.getElementById('calc-display').value = "Error";
                calcVal = "0";
            } 
        }

        // ãƒ¡ãƒ¢æ©Ÿèƒ½
        function saveMemo() { 
            localStorage.setItem('nh_memo', document.getElementById('memo-area').value); 
            alert("ãƒ–ãƒ©ã‚¦ã‚¶ã«ãƒ¡ãƒ¢ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼"); 
        }
        document.getElementById('memo-area').value = localStorage.getItem('nh_memo') || "";

        // æ¤œç´¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        document.getElementById('js-search').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            // æ¤œç´¢æ™‚ã¯è‡ªå‹•çš„ã«ãƒ›ãƒ¼ãƒ ã‚¿ãƒ–ã‚’è¡¨ç¤ºã•ã›ã‚‹
            document.getElementById('home-radio').checked = true;
            document.querySelectorAll('.scratch-project').forEach(p => {
                const title = p.querySelector('h3').innerText.toLowerCase();
                p.classList.toggle('search-hide', !title.includes(query));
            });
        });

        // ã„ã„ã­æ©Ÿèƒ½
        let likes = parseInt(localStorage.getItem('nh_likes')) || 0;
        document.getElementById('like-count').innerText = likes;
        function sendLike() { 
            likes++; 
            document.getElementById('like-count').innerText = likes; 
            localStorage.setItem('nh_likes', likes); 
        }

        window.onload = () => { 
            fetchWeather(); 
            updateStatus(); 
        };
        // --- ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç”Ÿæˆãƒ­ã‚¸ãƒƒã‚¯ ---
const passLenInput = document.getElementById('pass-length');
const passLenVal = document.getElementById('length-val');
passLenInput.addEventListener('input', () => passLenVal.innerText = passLenInput.value);

function generatePass() {
    const charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+";
    let retVal = "";
    for (let i = 0; i < passLenInput.value; ++i) {
        retVal += charset.charAt(Math.floor(Math.random() * charset.length));
    }
    document.getElementById('pass-display').innerText = retVal;
}

// --- ãƒãƒ¢ãƒ‰ãƒ¼ãƒ­ã‚¿ã‚¤ãƒãƒ¼ãƒ­ã‚¸ãƒƒã‚¯ ---
let timeLeft = 1500; // 25åˆ†
let timerId = null;

function updateTimerDisplay() {
    const mins = Math.floor(timeLeft / 60);
    const secs = timeLeft % 60;
    document.getElementById('timer-display').innerText = 
        `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
}

function toggleTimer() {
    const btn = document.getElementById('timer-btn');
    if (timerId) {
        clearInterval(timerId);
        timerId = null;
        btn.innerText = "å†é–‹";
    } else {
        btn.innerText = "åœæ­¢";
        timerId = setInterval(() => {
            timeLeft--;
            updateTimerDisplay();
            if (timeLeft <= 0) {
                clearInterval(timerId);
                alert("æ™‚é–“ã§ã™ï¼ä¼‘æ†©ã—ã¾ã—ã‚‡ã†ã€‚");
                resetTimer();
            }
        }, 1000);
    }
}

function resetTimer() {
    clearInterval(timerId);
    timerId = null;
    timeLeft = 1500;
    updateTimerDisplay();
    document.getElementById('timer-btn').innerText = "ã‚¹ã‚¿ãƒ¼ãƒˆ";
}
document.getElementById('screenshot-input').addEventListener('change', async (e) => {
    const file = e.target.files[0];
    if (!file) return;

    const status = document.getElementById('ocr-status');
    const resultArea = document.getElementById('analysis-result');
    const ocrText = document.getElementById('ocr-text');
    const tag = document.getElementById('category-tag');

    status.innerText = "âŒ› è§£æä¸­ (ã“ã‚Œã«ã¯æ•°ç§’ã‹ã‹ã‚Šã¾ã™)...";
    resultArea.style.display = "none";

    try {
        // Tesseract.jsã§è§£æï¼ˆæ—¥æœ¬èªã¨è‹±èªã«å¯¾å¿œï¼‰
        const { data: { text } } = await Tesseract.recognize(file, 'jpn+eng');
        
        status.innerText = "âœ… è§£æå®Œäº†";
        resultArea.style.display = "block";
        ocrText.value = text;

        // ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹è‡ªå‹•åˆ†é¡
        if (text.includes("éŠ€è¡Œ") || text.includes("å£åº§") || text.includes("æŒ¯è¾¼")) {
            tag.innerText = "ğŸ’° æŒ¯è¾¼ãƒ»å£åº§æƒ…å ±";
            tag.style.background = "#e67e22";
        } else if (text.includes("åº—") || text.includes("äºˆç´„") || text.includes("MAP") || text.includes("TEL")) {
            tag.innerText = "ğŸ“ è¡ŒããŸã„ãŠåº—";
            tag.style.background = "#3498db";
        } else {
            tag.innerText = "ğŸ“ ä¸€èˆ¬ãƒ¡ãƒ¢";
            tag.style.background = "#2ecc71";
        }

    } catch (err) {
        console.error(err);
        status.innerText = "âŒ è§£æã«å¤±æ•—ã—ã¾ã—ãŸ";
    }
});

// ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
document.getElementById('copy-ocr-btn').onclick = () => {
    const text = document.getElementById('ocr-text');
    text.select();
    document.execCommand('copy');
    alert("ãƒ†ã‚­ã‚¹ãƒˆã‚’ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
};
function processCode(mode) {
    const codeArea = document.getElementById('code-input');
    let code = codeArea.value;

    if (!code.trim()) return alert("ã‚³ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");

    try {
        if (mode === 'minify') {
            // --- å¼·åŒ–ç‰ˆï¼šé™ç•Œã¾ã§çŸ­ç¸® ---
            code = code
                .replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm, '$1') // ã‚³ãƒ¡ãƒ³ãƒˆå‰Šé™¤
                .replace(/\s+([\{\}\(\)\[\]\=\+\-\*\/\;\:\,])\s*/g, '$1') // è¨˜å·å‘¨ã‚Šã®ç©ºç™½ã‚’è©°ã‚ã‚‹
                .replace(/\s+/g, ' ') // é€£ç¶šã™ã‚‹ç©ºç™½ã‚’1ã¤ã«
                .replace(/;}/g, '}') // æœ€å¾Œã®ã‚»ãƒŸã‚³ãƒ­ãƒ³ã‚’å‰Šé™¤
                .trim();
            alert("ã‚³ãƒ¼ãƒ‰ã‚’åœ§ç¸®ã—ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        } else {
            // --- å¼·åŒ–ç‰ˆï¼šç°¡æ˜“ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆæ•´å½¢ ---
            let indent = 0;
            const spaces = "    "; // 1ã‚¤ãƒ³ãƒ‡ãƒ³ãƒˆ4ã‚¹ãƒšãƒ¼ã‚¹
            code = code
                .replace(/\s*\{\s*/g, " {\n")
                .replace(/\s*\}\s*/g, "\n}\n")
                .replace(/\s*;\s*/g, ";\n")
                .split('\n')
                .map(line => {
                    line = line.trim();
                    if (line.match(/\}/)) indent--;
                    const currentLine = (indent > 0 ? spaces.repeat(indent) : "") + line;
                    if (line.match(/\{/)) indent++;
                    return currentLine;
                })
                .join('\n')
                .replace(/\n\s*\n/g, '\n'); // ç©ºè¡Œã‚’è©°ã‚ã‚‹
            alert("ã‚³ãƒ¼ãƒ‰ã‚’æ•´å½¢ã—ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼");
        }

        codeArea.value = code;
        
        // è‡ªå‹•ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
        navigator.clipboard.writeText(code).catch(err => {
            console.error('Copy failed', err);
        });

    } catch (e) {
        alert("å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚");
    }
}
    </script>
</body>
</html>





